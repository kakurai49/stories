{
  "id": "blk_0d97af971993c89afd17188a47b860c01bdda9cb",
  "source": "POM は効いた。だが、まだ痛みは残る。\nテストが落ちるたびに、POM とテストの境界で“何をどこまで知るか”が曖昧になり、メンテは局所最適に陥る。コードは整理されても、変更の衝撃は漏れてくる。\n\nナギはホワイトボードに新しい箱を描いた。\nWorldState：アプリ全体の状態（ログイン、画面、ユーザー属性、データの有無）\nLens：WorldState から特定画面の操作と観測だけを切り出す“レンズ”\nTest：Lens を通して S だけを見る\n\n「テストは GUI を見ない。レンズが見る。テストは“観点”を語るだけ」\n真壁が眉を上げた。「POM のさらに下に隠すんすか？」\n「はい。GUI の詳細は、漏れると毒になる。閉じ込めましょう」\n\nナギは LoginScreenLens の例をその場で書いた。\ninput_credentials(user)\nsubmit()\nshows_error(message)\n\n「ロケータが変わったら？」\nミオが答える。「Lens の中だけ直す」\n「そう。テストは触らない。“観点カード”も変えない。S が変わらない限り、テストはそのまま生きる」\n\n古参が不安そうに言う。「抽象化しすぎると、何が起きてるか分からなくなる」\nナギは首を振った。「分からなくなるのは、ログがないから。WorldState を記録する。レンズは“見えるようにする”ためにもある」\n\n彼女は実際に、テスト失敗時のログに WorldState のスナップショットを出す仕組みを入れた。\n「今までは、落ちたら動画を眺めるしかなかった。これからは、状態の差分を読む」\n\n真壁が腕を組み直す。「……これ、POM よりもう一段“下”で GUI を隠してないか？」\n「はい。G のレイヤに GUI を閉じ込める設計です」\n\nミオは、テストが“画面の操り人形”から“観点の証言者”に変わっていく感覚を覚えた。\n会議室の窓の外で夕日が沈む。赤い Jenkins の色が、少しだけ薄く見えた。",
  "type": "Markdown"
}
